<!--! author="Charles Galambos, Bill Christmas" -->
: 

<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
  <head>
    <title>Image Input and Output</title>
  </head>

<body>

<p> RAVL includes a comprehensive mechanism for reading and writing objects
from and to files in a uniform and transparent fashion.  It is based around two
global functions: <code>Load</code> and <code>Save</code>.  In particular,
there is a set of routines to handle a variety of image file formats, together
with the ability to convert between several different pixel representations.

<p> The generic load/save mechanism is described <a href="Ravl.Core.IO.html">here</a>.  In order
to invoke the libraries specific to image I/O, you need to:<ul> 
<li> insert this header file:
<pre>
#include "Ravl/DP/FileFormatIO.hh"
</pre>
<li> add this library in the <code>defs.mk</code>:
<pre>
USESLIBS = RavlImageIO ....
</pre>
</ul>
Hopefully some of this paraphernalia will not be necessary in the future...

<p> The generic load/save call can then be used in the <a
href="Ravl.Core.IO.html">usual way</a>.

For an example of how to use the system with
images see <a href="../../../examples/exImgIO.cc">exImgIO.cc</a>.
(Remember: to compile this example you'll need the "DPImageIO" library.)

<p> To find what file formats and conversions are available, use the <code>conv</code> tool, with the following options:
<dl>
<dt><code>-lf</code> - list all known file formats
<dt><code>-lc</code> - list all known conversions
<dt><code>-lt</code> - list all known classes (?)
</dl>


<h3>Creating image converters</h3>

If you wish to load and save your own image type as <code>ppm</code>,
<code>pgm</code> or any other file format that is already supported, and the
particular conversion you want is not currently available, it is
straightforward to add one to the collection (currently in
<code>Ravl/Image/ImageIO/ImgTypeCnv.cc)</code>.  Following is an example for
converting a byte image into a double image.  For more information on writing
converters see <a href="Ravl.Core.IO.html">Basic Types.IO</a>
<pre>

ImageC&lt RealT&gt DPConvImageC<ByteT>T2RealImageCT(const ImageC&lt ByteT&gt &dat)  
{ 
  ImageC&lt RealT&gt ret(dat.Rectangle());
  for(Array2dIter2C&lt RealT,ByteT&gt it(ret,dat);it;it++) 
    it.Data1() = (RealT) it.Data2();
  return ret;
}

DP_REGISTER_CONVERTION(ImageC<ByteT>T2RealImageCT, 1);
</pre>
The argument in the function call indicates (as a ratio of the number of bytes
in the respective pixels) the amount of information lost in the conversion.  In
this example, no information is lost, so the ratio is 1.  For double to char conversion, the ration would be 8.

</body>
</html>
