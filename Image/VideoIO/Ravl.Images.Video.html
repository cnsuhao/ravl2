<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>Video Sequences</title>
  </head>
  <body>
    <p>
      Sequences of images are handled in RAVL in a similar way to
      sequences of any other kind of object. Details of how streams
      work can be found in <a
      href="Ravl.OS.Sequence.html">Ravl.OS.Sequence</a>.  The
      differences between image sequences and other RAVL sequences
      are:</p>

    <ul>
      <li> A variety of "standard" video formats are supported (see
      below).  Where the data has a distinctive header (e.g. JPEG),
      this is used to determine the format; otherwise (e.g. the CIF
      family) the filename suffix is used.</li> 

      <li> Where there is a mismatch between the pixel types in file
      and image (for example when reading a CIF video file into
      ImageC&lt;RGBValueC&gt;), the appropriate conversion is
      automatically done.</li> 
      
      <li>As well as reading and writing files, the <a
      href="Ravl.Core.IO.Virtual_Files.html">virtual files</a>
      mechanism provides direct access to selected devices such as a
      window on the screen.</li>
    </ul>

    <h1>Supported formats</h1>
    <p>
      For an exhaustive list of all supported formats (including much
      besides images and video, but no including the virtual files),
      use the 'conv -lf' command.  Here's an out-of date summary of
      some of them:</p>

    <ul>
      <li><b>sqcif</b> Binary byte YUV420 images, 72 by 88
      <li><b>qcif</b>  Binary byte YUV420 images, 144 by 176
      <li><b>cif</b>  Binary byte YUV420 images, 288 by 352
      <li><b>4cif</b>  Binary byte YUV420 images, 576 by 704
      <li><b>16cif</b>  Binary byte YUV420 images, 1152 by 1408
      <li><b>yuv</b> Binary byte YUV images, 576 by 720
      <li><b>syuv</b> Binary byte YUV images, 576 by 720 one image to a file.
      <li><b>rgb</b>  Binary byte RGB images, 242 by 360
      <li><b>rgb2</b> Binary byte RGB images, 288 by 384
      <li><b>frgb</b> Binary byte RGB images, 484 by 720
      <li><b>frgb2</b> Binary byte RGB images, 576 by 768
      <li><b>jpeg</b> The libjpeg libraries support the storage of a sequence of compressed images in a single file.
    </ul>
    Note: In YUV420, the colour is sampled at half the resolution of the intensity in both dimensions.
    
    <p> If the video format that you wish to use is not listed above,
    then you may need to include other external libraries.  <a
    href="Ravl.Contrib.Video_IO.html"> Ravl.Contrib.Video IO </a> (if
    installed) is a good place to look for other file formats.
    Remember to include the appropriate headers files and libraries.
    </p>

    <h1>Programming the video I/O</h1>

    <p>Following is a example of how to use this mechanism to read and
      write a sequence of images.</p>
      
    <h3>Headers and libraries</h3>

    <p> Before you can do video IO there are a few things you have to do:</p>
    <ul>
      <li> insert this header file:
	<pre>
#include "Ravl/DP/SequenceIO.hh"
	</pre>
      <li> add this library in the <code>defs.mk</code>:
	<pre>
USESLIBS = RavlVideoIO ....
	</pre>
    </ul>

      
    <h3> Reading a sequence </h3>
    
    <p>Use <a href="../Class/RavlN.DPIPortC.html">DPIPortC</a>: </p>
    <pre>
    DPIPortC&lt;ImageC&lt;IntT&gt;  &gt; in;
    if(!OpenISequence(in,"myfile.cif")) {
      // Failed to open input file.
      // Report an error...
    }
    ImageC&lt;IntT&gt; value;
    while(in.Get(value)) { // Get next image, stop if none.
      
      ... Process your image...
      
    }
    </pre>
    
    <h3> Writting a sequence </h3>

    <p>Use <a href="../Class/RavlN.DPOPortC.html">DPOPortC</a>: </p>
    <pre>
    DPOPortC&lt;ImageC&lt;IntT&gt;  &gt; out;
    if(!OpenOSequence(out,"myfile.cif")) {
      // Failed to open output file.
      // Report an error..
    }

    while(... more images to write ...) {
      ImageC&lt;IntT&gt;  image; 
     
      ... Generate your images ....
      
      out.Put(image);
    } 
    </pre>

  </body>
</html>
